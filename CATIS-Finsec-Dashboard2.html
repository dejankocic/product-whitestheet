<!doctype html>
<html lang="en" data-theme="light">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>CATIS × Finsec — Dashboard (Plain CSS, Enriched, 100% Offline)</title>
  <style>
    :root{
      --primary:#5B5ED0; --primary-dark:#3E42B7; --accent:#D4AF37;
      --surface:#F4F5FF; --surface-dark:#0E0F1A; --card:#fff; --card-dark:#13162B; --text:#0F1222
    }
    html,body{height:100%}
    body{margin:0;font:14px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;background:var(--surface);color:var(--text)}
    [data-theme="dark"] body{background:var(--surface-dark);color:#fff}
    .wrap{max-width:1200px;margin:0 auto;padding:24px}

    /* Header */
    .header{display:flex;align-items:center;justify-content:space-between;gap:12px;background:rgba(255,255,255,.85);padding:12px 14px;border-radius:16px;box-shadow:0 6px 22px rgba(9,12,34,.06)}
    [data-theme="dark"] .header{background:rgba(26,29,51,.75)}
    .brand{display:flex;align-items:center;gap:10px}
    .logo{width:40px;height:40px;display:grid;place-items:center;color:#fff;border-radius:12px;background:linear-gradient(135deg,#5B5ED0,#3E42B7)}
    .badge{background:var(--accent);color:#1b1b1b;border-radius:999px;padding:2px 10px;font-size:12px;font-weight:700}
    .controls{display:flex;align-items:center;gap:8px}
    .switch{width:44px;height:24px;background:#c7cbe6;border-radius:999px;position:relative;cursor:pointer}
    .switch::after{content:'';position:absolute;top:3px;left:3px;width:18px;height:18px;background:#fff;border-radius:50%;box-shadow:0 2px 8px rgba(0,0,0,.2);transition:left .2s}
    .switch.on{background:var(--primary)} .switch.on::after{left:23px}

    /* Tabs */
    nav.tabs{display:flex;align-items:center;gap:8px;margin:14px 0}
    .tab{border:0;border-radius:10px;padding:8px 12px;font-weight:700;background:#fff;box-shadow:0 2px 8px rgba(9,12,34,.06);cursor:pointer}
    .tab.active{background:#edf1ff}
    [data-theme="dark"] .tab{background:#12142A;color:#e6e9ff}
    [data-theme="dark"] .tab.active{background:#1f2346}
    .btn{border:0;border-radius:12px;padding:10px 14px;font-weight:700;cursor:pointer}
    .btn.primary{background:var(--primary);color:#fff;box-shadow:0 4px 16px rgba(91,94,208,.35)}
    .btn.secondary{background:#e9ecff;color:#1b1b33}
    [data-theme="dark"] .btn.secondary{background:#1a1d33;color:#e6e9ff}

    /* Layout */
    .grid{display:grid;gap:16px}
    @media (min-width:900px){ .cols-2{grid-template-columns:repeat(2,minmax(0,1fr))} .cols-3{grid-template-columns:repeat(3,minmax(0,1fr))} .cols-4{grid-template-columns:repeat(4,minmax(0,1fr))} }

    /* Cards + typography */
    .card{background:var(--card);border-radius:16px;padding:16px;box-shadow:0 6px 22px rgba(9,12,34,.06)}
    [data-theme="dark"] .card{background:var(--card-dark)}
    .kpi{display:flex;align-items:center;justify-content:space-between}
    .kpi .big{font-size:36px;font-weight:800;letter-spacing:-.02em}
    .muted{color:#6B6F88}
    [data-theme="dark"] .muted{color:#b8bfd6}
    .hstack{display:flex;align-items:center;gap:8px}
    .vstack{display:grid;gap:8px}
    .badge-soft{display:inline-block;font-size:12px;border-radius:999px;padding:4px 8px;background:#edf1ff}
    [data-theme="dark"] .badge-soft{background:#1f2346;color:#e6e9ff}
    .bar{height:12px;width:100%;border-radius:10px;overflow:hidden;background:#e9ecf5}
    .bar > div{height:12px}
    .progress{display:flex;height:14px;overflow:hidden;border-radius:10px;background:#e9ecf5}
    [data-theme="dark"] .progress{background:#1f2346}
    .chip{display:inline-flex;align-items:center;gap:6px;padding:4px 8px;border-radius:999px;font-size:12px}
    .chip.ok{background:rgba(16,185,129,.18);color:#065f46}
    .chip.warn{background:rgba(245,158,11,.18);color:#8a5a00}
    [data-theme="dark"] .chip.ok{background:rgba(16,185,129,.25);color:#bdf7df}
    [data-theme="dark"] .chip.warn{background:rgba(245,158,11,.25);color:#ffe3a3}
    .list-slim{margin:0;padding-left:18px}
    .list-slim li{margin:4px 0}

    .hidden{display:none!important}
  </style>
</head>
<body>
  <div class="wrap">
    <!-- Header -->
    <header class="header">
      <div class="brand">
        <div class="logo">🛡️</div>
        <div>
          <div style="font-size:12px;text-transform:uppercase;letter-spacing:.08em" class="muted">CATIS × Finsec</div>
          <h1 style="margin:0;font-size:18px">Threat Intelligence Console</h1>
        </div>
        <span class="badge">Beta Mock</span>
      </div>
      <div class="controls">
        <div class="hstack" style="background:#edf1ff;border-radius:12px;padding:6px 10px">
          <span class="muted" style="font-size:14px">Dark Theme</span>
          <div id="themeSwitch" class="switch" role="switch" aria-checked="false" tabindex="0"></div>
        </div>
        <button id="exportBtn" class="btn primary">⬇ Export PNG</button>
      </div>
    </header>

    <!-- Tabs -->
    <nav class="tabs">
      <button id="tab-overview" class="tab active">Overview</button>
      <button id="tab-attack"   class="tab">Attack Types</button>
      <button id="tab-trends"   class="tab">Trends & Risk</button>
      <div style="flex:1"></div>
      <button class="btn secondary" onclick="alert('Docs (mock)')">View Docs ➜</button>
    </nav>

    <!-- OVERVIEW -->
    <section id="panel-overview">
      <div id="overview-capture" class="grid cols-3">
        <!-- 1) Alert Volume -->
        <div class="card">
          <div class="hstack" style="justify-content:space-between">
            <h3 style="margin:0">📣 Alert Volume</h3>
            <span class="badge-soft">Last 24h</span>
          </div>
          <div class="kpi" style="margin-top:6px">
            <div>
              <div class="muted" style="font-size:12px">Total Alerts</div>
              <div class="big">17,867</div>
            </div>
            <div class="vstack" style="min-width:160px">
              <div class="hstack" style="justify-content:space-between"><span>High</span><strong>66</strong></div>
              <div class="hstack" style="justify-content:space-between"><span>Medium</span><strong>17,440</strong></div>
              <div class="hstack" style="justify-content:space-between"><span>Low</span><strong>361</strong></div>
            </div>
          </div>
          <div class="bar" style="margin-top:10px">
            <div style="width:0.4%;background:#ef4444"></div>
            <div style="margin-top:-12px;width:96.6%;background:#f59e0b"></div>
            <div style="margin-top:-12px;width:2%;background:#9ca3af"></div>
          </div>
        </div>

        <!-- 2) Attacker Insights -->
        <div class="card">
          <div class="hstack" style="justify-content:space-between">
            <h3 style="margin:0">🕵️ Attacker Insights</h3>
            <span class="badge-soft">Distinct sources</span>
          </div>
          <div class="kpi" style="margin-top:6px">
            <div>
              <div class="muted" style="font-size:12px">Unique Attackers</div>
              <div class="big">5,462</div>
            </div>
            <div class="vstack" style="min-width:200px;font-size:14px">
              <div class="hstack" style="justify-content:space-between"><span>🇨🇳 China</span><strong>1,519</strong></div>
              <div class="hstack" style="justify-content:space-between"><span>🇺🇸 United States</span><strong>1,491</strong></div>
              <div class="hstack" style="justify-content:space-between"><span>🇷🇸 Serbia</span><strong>1,233</strong></div>
              <div class="hstack" style="justify-content:space-between"><span>🇩🇪 Germany</span><strong>840</strong></div>
            </div>
          </div>
        </div>

        <!-- 3) Attack Surface -->
        <div class="card">
          <div class="hstack" style="justify-content:space-between">
            <h3 style="margin:0">🛡️ Attack Surface</h3>
            <span class="badge-soft">Observed</span>
          </div>
          <div class="kpi" style="margin-top:6px">
            <div>
              <div class="muted" style="font-size:12px">Total Attacks</div>
              <div class="big">321,132</div>
            </div>
            <div class="vstack" style="min-width:220px;font-size:14px">
              <div class="hstack" style="justify-content:space-between"><span>Phishing / Social</span><strong>38%</strong></div>
              <div class="hstack" style="justify-content:space-between"><span>Exploits / Scans</span><strong>34%</strong></div>
              <div class="hstack" style="justify-content:space-between"><span>Malware / Payloads</span><strong>20%</strong></div>
              <div class="hstack" style="justify-content:space-between"><span>Other</span><strong>8%</strong></div>
            </div>
          </div>
        </div>

        <!-- 4) Operational Metrics -->
        <div class="card">
          <h3 style="margin:0">⚙️ Operational Metrics</h3>
          <div class="grid cols-3" style="margin-top:8px">
            <div class="vstack">
              <div class="muted" style="font-size:12px">SLA Uptime</div>
              <div class="big">99.98%</div>
            </div>
            <div class="vstack">
              <div class="muted" style="font-size:12px">MTTD</div>
              <div class="big">&lt; 1s</div>
            </div>
            <div class="vstack">
              <div class="muted" style="font-size:12px">MTTR</div>
              <div class="big">&lt; 5m</div>
            </div>
          </div>
        </div>

        <!-- 5) Risk & Compliance -->
        <div class="card">
          <h3 style="margin:0">🧭 Risk & Compliance</h3>
          <div class="grid cols-2" style="margin-top:8px">
            <div>
              <div class="muted" style="font-size:12px">Risk Score</div>
              <div class="hstack" style="gap:10px">
                <div class="big">65</div>
                <div>/ 100</div>
              </div>
              <div class="bar" style="margin-top:8px">
                <div style="width:65%;background:linear-gradient(90deg,#22c55e,#f59e0b,#ef4444)"></div>
              </div>
              <div class="muted" style="margin-top:6px">Medium risk</div>
            </div>
            <div class="vstack">
              <div class="chip ok">ISO 27001: Pass</div>
              <div class="chip ok">NIST 800-53: Pass</div>
              <div class="chip warn">GDPR: Pending</div>
            </div>
          </div>
        </div>

        <!-- 6) Value Metrics -->
        <div class="card">
          <h3 style="margin:0">💰 Value Metrics</h3>
          <div class="grid cols-2" style="margin-top:8px">
            <div>
              <div class="muted" style="font-size:12px">Cost Avoided</div>
              <div class="big">$2.3M</div>
            </div>
            <div>
              <div class="muted" style="font-size:12px">Automation Rate</div>
              <div class="big">73%</div>
            </div>
          </div>
          <div class="muted" style="margin-top:6px;font-size:12px">Estimates based on prevented incidents & auto-resolutions.</div>
        </div>
      </div>
    </section>

    <!-- ATTACK TYPES -->
    <section id="panel-attack" class="hidden">
      <div id="attack-capture" class="grid cols-3">
        <div class="card">
          <h3 style="margin:0">🛰️ Low Priority</h3>
          <div class="big">301,761</div>
          <div class="progress" title="Known/Unknown/Other" style="margin-top:8px">
            <div style="width:60%;background:var(--primary)"></div>
            <div style="width:39.8%;background:var(--accent)"></div>
            <div style="width:.2%;background:rgba(255,255,255,.5)"></div>
          </div>
          <ul class="list-slim">
            <li><strong>181,019</strong> — Baithive Request Attempt</li>
            <li><strong>120,189</strong> — Trap Event</li>
            <li><strong>553</strong> — IP unknown to 3rd‑party TI</li>
          </ul>
        </div>
        <div class="card">
          <h3 style="margin:0">📊 Medium Priority</h3>
          <div class="big">19,465</div>
          <div class="progress" title="Novel Payload / Fuzzing / Geo-targeted" style="margin-top:8px">
            <div style="width:79.7%;background:var(--primary)"></div>
            <div style="width:11.3%;background:var(--accent)"></div>
            <div style="width:9.0%;background:rgba(255,255,255,.5)"></div>
          </div>
          <ul class="list-slim">
            <li><strong>15,522</strong> — Novel payload</li>
            <li><strong>2,193</strong> — Fuzzing attack</li>
            <li><strong>1,750</strong> — Geo‑targeted</li>
          </ul>
        </div>
        <div class="card">
          <h3 style="margin:0">🔔 High Priority</h3>
          <div class="big">99</div>
          <div class="progress" style="margin-top:8px">
            <div style="width:100%;background:var(--primary)"></div>
          </div>
          <ul class="list-slim">
            <li><strong>99</strong> — Probably human‑operated</li>
          </ul>
        </div>
      </div>
    </section>

    <!-- TRENDS & RISK -->
    <section id="panel-trends" class="hidden">
      <div id="trends-capture" class="grid cols-3">
        <div class="card">
          <h3 style="margin:0">📈 Attack Trends (7d)</h3>
          <p style="margin:.5rem 0 0">Steady rise with 2 spikes (Tue, Fri). Plan surge response staffing.</p>
          <div class="bar" style="margin-top:10px;height:8px"><div style="width:72%;background:#5B5ED0;height:8px"></div></div>
        </div>
        <div class="card">
          <h3 style="margin:0">🧠 Zero‑day vs Known</h3>
          <div class="progress" style="margin-top:8px">
            <div style="width:12%;background:#ef4444" title="Zero-day ~12%"></div>
            <div style="width:88%;background:#22c55e" title="Known ~88%"></div>
          </div>
          <p class="muted" style="margin:.5rem 0 0;font-size:12px">Higher zero‑day ratio → increase deception coverage & sandboxing.</p>
        </div>
        <div class="card">
          <h3 style="margin:0">🔌 Integration Health</h3>
          <ul class="list-slim">
            <li>SIEM sync: <strong>OK</strong> (2m ago)</li>
            <li>EDR feed: <strong>OK</strong> (5m ago)</li>
            <li>Firewall rules push: <strong>Pending</strong> (approve)</li>
          </ul>
        </div>
        <div class="card">
          <h3 style="margin:0">👥 SOC Load</h3>
          <ul class="list-slim">
            <li>Open tickets: <strong>47</strong> (P1: 2, P2: 9)</li>
            <li>Auto‑resolved in last 24h: <strong>34</strong></li>
            <li>Analysts on duty: <strong>5</strong></li>
          </ul>
        </div>
        <div class="card">
          <h3 style="margin:0">🧪 Deception Coverage</h3>
          <p style="margin:.5rem 0 0">Active Cyber Clones: <strong>128</strong> (Ext: 80, Int: 48)</p>
          <p class="muted" style="margin:.25rem 0 0;font-size:12px">New attacker fingerprints captured: <strong>312</strong> / 24h</p>
        </div>
        <div class="card">
          <h3 style="margin:0">🧯 Incident Outcomes</h3>
          <ul class="list-slim">
            <li>Blocked at perimeter: <strong>62%</strong></li>
            <li>Contained post‑breach: <strong>35%</strong></li>
            <li>False positives: <strong>3%</strong></li>
          </ul>
        </div>
      </div>
    </section>

    <!-- Footer -->
    <footer class="header" style="margin-top:16px">
      <div class="controls">
        <span class="chip ok"><strong>99.98%</strong> SLA</span>
        <span class="chip ok"><strong>&lt;1s</strong> MTTD</span>
        <span class="chip warn"><strong>&lt;5m</strong> MTTR</span>
      </div>
      <div class="muted text-xs">🛡️ CATIS × Finsec – 100% offline mock</div>
    </footer>
  </div>

  <script>
    // Offline PNG exporter via SVG foreignObject
    async function nodeToPng(node, scale = 2) {
      const width = node.scrollWidth, height = node.scrollHeight;
      const cloned = node.cloneNode(true);
      Object.assign(cloned.style,{margin:'0',transform:`scale(${scale})`,transformOrigin:'top left',width:width+'px',height:height+'px'});
      const wrapper = document.createElement('div'); wrapper.setAttribute('xmlns','http://www.w3.org/1999/xhtml'); wrapper.style.width=width+'px'; wrapper.style.height=height+'px'; wrapper.appendChild(cloned);
      const fo = document.createElementNS('http://www.w3.org/2000/svg','foreignObject'); fo.setAttribute('x','0'); fo.setAttribute('y','0'); fo.setAttribute('width',width*scale); fo.setAttribute('height',height*scale); fo.appendChild(wrapper);
      const svg = document.createElementNS('http://www.w3.org/2000/svg','svg'); svg.setAttribute('xmlns','http://www.w3.org/2000/svg'); svg.setAttribute('width',width*scale); svg.setAttribute('height',height*scale); svg.setAttribute('viewBox',`0 0 ${width*scale} ${height*scale}`); svg.appendChild(fo);
      const svgString = new XMLSerializer().serializeToString(svg); const imgSrc = 'data:image/svg+xml;charset=utf-8,'+encodeURIComponent(svgString);
      const img = new Image(); img.decoding='sync'; img.crossOrigin='anonymous';
      await new Promise((res,rej)=>{ img.onload=res; img.onerror=rej; img.src=imgSrc; });
      const canvas = document.createElement('canvas'); canvas.width=width*scale; canvas.height=height*scale; const ctx=canvas.getContext('2d'); ctx.drawImage(img,0,0);
      return canvas.toDataURL('image/png');
    }

    // Tabs
    const tabs = {'tab-overview':'panel-overview','tab-attack':'panel-attack','tab-trends':'panel-trends'};
    Object.keys(tabs).forEach(id=>{
      document.getElementById(id).addEventListener('click',()=>{
        for(const k in tabs){
          document.getElementById(tabs[k]).classList.add('hidden');
          document.getElementById(k).classList.remove('active');
        }
        document.getElementById(tabs[id]).classList.remove('hidden');
        document.getElementById(id).classList.add('active');
      });
    });

    // Theme toggle
    const themeSwitch = document.getElementById('themeSwitch');
    function applyTheme(mode){
      document.documentElement.setAttribute('data-theme', mode);
      themeSwitch.classList.toggle('on', mode==='dark');
      localStorage.setItem('catis-finsec-theme', mode);
    }
    applyTheme(localStorage.getItem('catis-finsec-theme') || 'light');
    themeSwitch.addEventListener('click',()=>applyTheme(document.documentElement.getAttribute('data-theme')==='dark'?'light':'dark'));
    themeSwitch.addEventListener('keydown',(e)=>{ if(e.key==='Enter'||e.key===' '){ e.preventDefault(); themeSwitch.click(); } });

    // Export PNG (active panel)
    document.getElementById('exportBtn').addEventListener('click', async ()=>{
      const active = !document.getElementById('panel-overview').classList.contains('hidden') ? 'panel-overview' :
                     !document.getElementById('panel-attack').classList.contains('hidden')   ? 'panel-attack'   : 'panel-trends';
      const node = document.getElementById(active);
      try{
        const url = await nodeToPng(node, 2);
        const a = document.createElement('a'); a.href = url; a.download = active + '.png'; a.click();
      } catch(e){ alert('Export failed: ' + e.message); }
    });
  </script>
</body>
</html>
